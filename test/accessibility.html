<!doctype html>

<head>
  <meta charset="UTF-8">
  <title>vaadin-text-field tests</title>

  <script src="../../web-component-tester/browser.js"></script>
  <link rel="import" href="../vaadin-text-field.html">

</head>

<body>
  <test-fixture id="error-fixture">
    <template>
      <vaadin-text-field required error-message="ERR"></vaadin-text-field>
    </template>
  </test-fixture>

  <script>

    describe('accessibility', function() {
      let tf, err;

      beforeEach(function() {
        tf = fixture('error-fixture');
        err = tf.root.querySelector('[part=error-message]');
      });

      it('should have an error element classed with `error`', function() {
        expect(err).to.be.ok;
      });

      it('should not show the error message the very first time', function() {
        expect(window.getComputedStyle(err).display).to.equal('none');
      });

      it('should show the error message after validation is run', function() {
        tf.validate();
        expect(window.getComputedStyle(err).display).not.to.equal('none');
      });

      it('should not show the error message if error-message is empty', function() {
        tf.errorMessage = '';
        tf.validate();
        expect(window.getComputedStyle(err).display).to.equal('none');
      });

      it('should not have aria-describedby attribute if valid', function() {
        expect(tf.$.input.getAttribute('aria-describedby')).not.to.be.ok;
      });

      it('should have aria-describedby attribute when invalid', function() {
        tf.validate();
        expect(tf.$.input.getAttribute('aria-describedby')).to.equal(err.id);
      });

      it('should have appropriate aria-live attribute', function() {
        expect(err.getAttribute('aria-live')).to.equal('assertive');
      });

    });
  </script>
</body>
